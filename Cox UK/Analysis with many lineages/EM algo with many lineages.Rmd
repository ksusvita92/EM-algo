---
title: "EM algo with many lineages"
author: "Kurnia Susvitasari"
date: '2020-06-22'
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    number_sections: TRUE
    fig_height: 6
---

# Dataprep

In this analysis, we perform EM-algo from a collection of sampled transmission trees from a various lineages. We filter out all observation that have both genomic sequence and sample date information. For now, we pretend that the sample date is the onset date.

We present EM-algo in 8 different lineages. In each lineage, we will choose various SNP cut-offs to determine the genomic clusters. Below is the summary of each lineage used in here:

  + **lineage B**:
      + There are 83 data points.
      + Choosen SNP cutoff=0,1,3,4.
  + **lineage B.1.1**:
      + There are 95 data points.
      + Choosen SNP cutoff=0,1,2,5.
  + **lineage B.1.11**:
      + There are 84 data points.
      + Choosen SNP cutoff=0,4.
  + **lineage B.1.13**:
      + There are 40 data points.
      + Choosen SNP cutoff=0,1,3.
  + **lineage B.1.5**:
      + There are 58 data points.
      + Choosen SNP cutoff=0,1,3,4.
  + **lineage B.1.7**:
      + There are 41 data points.
      + Choosen SNP cutoff=0,1,2.
  + **lineage B.2**:
      + There are 119 data points.
      + Choosen SNP cutoff=0,1,2,5.
  + **lineage B.3**:
      + There are 53 data points.
      + Choosen SNP cutoff=0,1,3,4.

Below is the summary of the number of clusters in different cut-off of each lineage.
      
```{r dataprep, message=F}
source("dataprep.R")
```

# Perform EM-algo

We begin by sampling $n=100$ transmission trees, and then we perform EM-algo in each tree. 

By performing EM-algo, we will get estimate of $\alpha, \beta, w_1, \ldots, w_4$. The repetition of this analysis is equivalent to performing bootstrapping.

## Lineage B

We filter out lineage B before we use it. There are 83 observations and we perform EM-algo with 4 different cut-offs: 0,1,3,4.

```{r lineage B, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.R")
```

Below are the boxplots of the estimates from $n=100$ transmission trees. We define the mixture mean of the serial interval as follows:

\begin{align}
  \mathbb{E}(X)&=w_1\mathbb{E}(X: f_1)+w_2\mathbb{E}(X: f_2)+w_3\mathbb{E}(X: f_3)+w_4\mathbb{E}(X: f_4)
  \nonumber \\
  &=w_1\alpha\beta + 2w_2\alpha\beta + 3w_3\alpha\beta + 4w_4\alpha\beta.
\end{align}

### Bootstrap dist. of the estimates

```{r lineage B output, message=F, eval=T, fig.height=4}
require(ggplot2)

alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B weight, message=F}
require(reshape2)

weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=2) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B summary, message=F, warning=F}
summary <- NULL
result <- NULL

summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B", nrow(result_)))
result <- bind_rows(result, result_)

rm(lineB, record)
rm(list=grep("_", ls(), value=T))
```

## Lineage B.1.1

There are 95 data points. Here we perform EM-algo with different cut-offs, as follows: 0,1,2,5.

```{r lineage B.1.1, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.1.1.R")
```

### Bootstrap dist. of the estimates

```{r lineage B.1.1 output, message=F, eval=T, fig.height=4}
alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.1")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.1")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.1")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B.1.1 weight, message=F}
weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=2) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B.1.1 summary, message=F, warning=F}
summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B.1.1", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B.1.1", nrow(result_)))
result <- bind_rows(result, result_)

rm(record)
rm(list=grep("_", ls(), value=T))
```

## Lineage B.1.11

There are 84 data points. Here we perform EM-algo with different cut-offs, as follows: 0,4.

```{r lineage B.1.11, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.1.11.R")
```

### Bootstrap dist. of the estimates

```{r lineage B.1.11 output, message=F, eval=T, fig.height=4}
alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.11")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.11")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.11")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B.1.11 weight, message=F, fig.height=4}
weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=1) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B.1.11 summary, message=F, warning=F}
summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B.1.11", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B.1.11", nrow(result_)))
result <- bind_rows(result, result_)

rm(record)
rm(list=grep("_", ls(), value=T))
```

## Lineage B.1.13

There are 40 data points. Here we perform EM-algo with different cut-offs, as follows: 0,1,3.

```{r lineage B.1.13, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.1.13.R")
```

### Bootstrap dist. of the estimates

```{r lineage B.1.13 output, message=F, eval=T, fig.height=4}
alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.13")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.13")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.13")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B.1.13 weight, message=F, fig.height=4}
weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=1) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B.1.13 summary, message=F, warning=F}
summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B.1.13", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B.1.13", nrow(result_)))
result <- bind_rows(result, result_)

rm(record)
rm(list=grep("_", ls(), value=T))
```


## Lineage B.1.5

There are 58 data points. Here we perform EM-algo with different cut-offs, as follows: 0,1,3,4.

```{r lineage B.1.5, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.1.5.R")
```

### Bootstrap dist. of the estimates

```{r lineage B.1.5 output, message=F, eval=T, fig.height=4}
alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.5")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.5")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.5")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B.1.5 weight, message=F, fig.height=4}
weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=2) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B.1.5 summary, message=F, warning=F}
summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B.1.5", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B.1.5", nrow(result_)))
result <- bind_rows(result, result_)

rm(record)
rm(list=grep("_", ls(), value=T))
```

## Lineage B.1.7

There are 41 data points. Here we perform EM-algo with different cut-offs, as follows: 0,1,2.

```{r lineage B.1.7, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.1.7.R")
```

### Bootstrap dist. of the estimates

```{r lineage B.1.7 output, message=F, eval=T, fig.height=4}
alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.5")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.5")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.1.5")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B.1.7 weight, message=F, fig.height=4}
weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=1) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B.1.7 summary, message=F, warning=F}
summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B.1.7", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B.1.7", nrow(result_)))
result <- bind_rows(result, result_)

rm(record)
rm(list=grep("_", ls(), value=T))
```

## Lineage B.2

There are 119 data points. Here we perform EM-algo with different cut-offs, as follows: 0,1,2,5.

```{r lineage B.2, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.2.R")
```

### Bootstrap dist. of the estimates

```{r lineage B.2 output, message=F, eval=T, fig.height=4}
alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.2")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.2")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.2")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B.2 weight, message=F, fig.height=4}
weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=2) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B.2 summary, message=F, warning=F}
summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B.1.5", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B.2", nrow(result_)))
result <- bind_rows(result, result_)

rm(record)
rm(list=grep("_", ls(), value=T))
```

## Lineage B.3

There are 53 data points. Here we perform EM-algo with different cut-offs, as follows: 0,1,3,4.

```{r lineage B.3, message=F, warning=F, fig.show='hide', results='hide', eval=T}
source("lineage B.1.5.R")
```

### Bootstrap dist. of the estimates

```{r lineage B.3 output, message=F, eval=T, fig.height=4}
alpha_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=alpha, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.3")
beta_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=beta, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.3")
mixtureMean_ <- ggplot(record, aes(x=cutoff)) + 
  geom_boxplot(aes(y=mixtureMean, fill=ncomp), alpha=.3) +
  theme(legend.position="bottom") + xlab("") +
  ggtitle("Lineage B.3")
alpha_; beta_; mixtureMean_
```

### Dist. of weights

Below are the distribution of weight $w_1,\ldots,w_4$. Note that $w_n$ is the weight of $n$-th component. 

```{r lineage B.3 weight, message=F, fig.height=4}
weight_ <- record %>% filter(ncomp=="ncomp=4")
weight_ <- melt(weight_[,c(3:6,10)])
ggplot(weight_) + 
  geom_histogram(aes(x=value, y=..density.., fill=variable), col="black", alpha=.3) +
  facet_wrap(~cutoff, nrow=2) + theme(legend.position="bottom")
```

From the histogram above, the 4th component is not very significant for lineage B. The following is the mixture mean summary of each cut-off with $ncomp=3$.

```{r lineage B.3 summary, message=F, warning=F}
summary_ <- record %>% filter(ncomp=="ncomp=3") %>% group_by(cutoff, ncomp) %>%
  summarise(meanSI=mean(mixtureMean), lowerCI=quantile(mixtureMean, 0.025), upperCI=quantile(mixtureMean, 0.975))
summary_$lineage <- with(summary_, rep("lineage B.3", nrow(summary_)))
summary <- bind_rows(summary, summary_)

result_ <- record %>% filter(ncomp=="ncomp=3")
result_$lineage <- with(result_, rep("lineage B.3", nrow(result_)))
result <- bind_rows(result, result_)

rm(record)
rm(list=grep("_", ls(), value=T))
```

# Summary

Below is the summary of the mixture mean of the serial interval in each lineage.

```{r summary, warning=F, message=F, echo=1}
print.data.frame(summary)

ggplot(result %>% filter(lineage=="lineage B")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B mixture mean") +
  facet_wrap(~cutoff, nrow=2)
ggplot(result %>% filter(lineage=="lineage B.1.1")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B.1.1 mixture mean") +
  facet_wrap(~cutoff, nrow=2)
ggplot(result %>% filter(lineage=="lineage B.1.11")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B.1.11 mixture mean") +
  facet_wrap(~cutoff, nrow=1)
ggplot(result %>% filter(lineage=="lineage B.1.13")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B.1.13 mixture mean") +
  facet_wrap(~cutoff, nrow=2)
ggplot(result %>% filter(lineage=="lineage B.1.5")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B.1.5 mixture mean") +
  facet_wrap(~cutoff, nrow=2)
ggplot(result %>% filter(lineage=="lineage B.1.7")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B.1.7 mixture mean") +
  facet_wrap(~cutoff, nrow=2)
ggplot(result %>% filter(lineage=="lineage B.2")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B.2 mixture mean") +
  facet_wrap(~cutoff, nrow=2)
ggplot(result %>% filter(lineage=="lineage B.3")) + 
  geom_histogram(aes(x=mixtureMean), col="black", fill="white") +
  xlab("") + ggtitle("lineage B.3 mixture mean") +
  facet_wrap(~cutoff, nrow=2)
```